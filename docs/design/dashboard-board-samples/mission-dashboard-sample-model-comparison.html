<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Comparison — LLM Performance Benchmarks</title>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.6.0/dist/echarts.min.js"></script>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: #0f1117;
    color: #e0e0e0;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
    line-height: 1.6;
    padding: 24px 32px 48px;
    min-height: 100vh;
  }

  /* ── Header ────────────────────────────────────── */
  .header { margin-bottom: 28px; }
  .header h1 {
    font-size: 26px;
    font-weight: 700;
    color: #e0e0e0;
    letter-spacing: -0.3px;
  }
  .header .timestamp {
    font-size: 13px;
    color: #8b8fa3;
    margin-top: 4px;
  }
  .header .synopsis {
    font-size: 14px;
    color: #8b8fa3;
    margin-top: 8px;
    max-width: 820px;
    line-height: 1.55;
  }

  /* ── Interactivity hint ────────────────────────── */
  .interaction-hint {
    background: linear-gradient(135deg, rgba(99,102,241,0.12) 0%, rgba(34,211,238,0.08) 100%);
    border: 1px solid rgba(99,102,241,0.25);
    border-radius: 8px;
    padding: 10px 16px;
    font-size: 13px;
    color: #a5a8c0;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .interaction-hint .icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  /* ── Card system ───────────────────────────────── */
  .card {
    background: #1a1d27;
    border: 1px solid #2a2d37;
    border-radius: 10px;
    padding: 20px 24px;
  }
  .card-title {
    font-size: 15px;
    font-weight: 600;
    color: #e0e0e0;
    margin-bottom: 16px;
  }

  /* ── KPI row ───────────────────────────────────── */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 16px;
    margin-bottom: 24px;
  }
  .kpi-card {
    background: #1a1d27;
    border: 1px solid #2a2d37;
    border-radius: 10px;
    padding: 18px 20px;
    position: relative;
    overflow: hidden;
  }
  .kpi-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    border-radius: 10px 10px 0 0;
  }
  .kpi-card.claude-opus::before   { background: #6366f1; }
  .kpi-card.claude-sonnet::before { background: #818cf8; }
  .kpi-card.claude-haiku::before  { background: #22d3ee; }
  .kpi-card.gpt-4o::before        { background: #10b981; }
  .kpi-card.gpt-4o-mini::before   { background: #f59e0b; }

  .kpi-model-name {
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 12px;
  }
  .kpi-card.claude-opus   .kpi-model-name { color: #6366f1; }
  .kpi-card.claude-sonnet .kpi-model-name { color: #818cf8; }
  .kpi-card.claude-haiku  .kpi-model-name { color: #22d3ee; }
  .kpi-card.gpt-4o        .kpi-model-name { color: #10b981; }
  .kpi-card.gpt-4o-mini   .kpi-model-name { color: #f59e0b; }

  .kpi-metrics { display: flex; flex-direction: column; gap: 8px; }
  .kpi-metric {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 13px;
  }
  .kpi-metric .label { color: #8b8fa3; }
  .kpi-metric .value { color: #e0e0e0; font-weight: 600; font-variant-numeric: tabular-nums; }
  .kpi-metric .value.best {
    color: #fbbf24;
    position: relative;
  }
  .kpi-metric .value.best::before {
    content: '\u2605 ';
    font-size: 12px;
  }

  /* ── Chart grid ────────────────────────────────── */
  .chart-grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 24px;
  }
  .chart-full {
    margin-bottom: 24px;
  }
  .chart-container {
    width: 100%;
    height: 420px;
  }
  .chart-container.tall {
    height: 460px;
  }

  /* ── Responsive ─────────────────────────────────── */
  @media (max-width: 1200px) {
    .kpi-row { grid-template-columns: repeat(3, 1fr); }
    .chart-grid-2 { grid-template-columns: 1fr; }
  }
  @media (max-width: 768px) {
    body { padding: 16px; }
    .kpi-row { grid-template-columns: 1fr 1fr; }
  }
</style>
</head>
<body>

<!-- ═══════════════  HEADER  ═══════════════ -->
<div class="header">
  <h1>Model Comparison &mdash; LLM Performance Benchmarks</h1>
  <div class="timestamp" id="timestamp"></div>
  <p class="synopsis">Side-by-side comparison of LLM models across quality, speed, cost, and reliability dimensions.</p>
</div>

<!-- ═══════════════  INTERACTIVITY  ═══════════════ -->
<div class="interaction-hint">
  <span class="icon">&#9432;</span>
  <span>Hover for model details. Drag parallel coordinate axes to filter. Click radar segments to compare.</span>
</div>

<!-- ═══════════════  KPI CARDS  ═══════════════ -->
<div class="kpi-row" id="kpi-row"></div>

<!-- ═══════════════  RADAR  +  GROUPED BAR  ═══════════════ -->
<div class="chart-grid-2">
  <div class="card">
    <div class="card-title">Model Capabilities Spider Chart</div>
    <div class="chart-container" id="chart-radar"></div>
  </div>
  <div class="card">
    <div class="card-title">Response Time by Model (P50, P95, P99)</div>
    <div class="chart-container" id="chart-bar-latency"></div>
  </div>
</div>

<!-- ═══════════════  PARALLEL COORDINATES  ═══════════════ -->
<div class="chart-full card">
  <div class="card-title">Multi-Dimensional Model Analysis</div>
  <div class="chart-container tall" id="chart-parallel"></div>
</div>

<!-- ═══════════════  SCATTER  +  STACKED BAR  ═══════════════ -->
<div class="chart-grid-2">
  <div class="card">
    <div class="card-title">Cost vs Quality Trade-off</div>
    <div class="chart-container" id="chart-scatter"></div>
  </div>
  <div class="card">
    <div class="card-title">Model Usage Share Over Time (30 days)</div>
    <div class="chart-container" id="chart-stacked"></div>
  </div>
</div>

<script>
// ─────────────────────────────────────────────
// DATA
// ─────────────────────────────────────────────
const MODEL_COLORS = {
  'Claude Opus':   '#6366f1',
  'Claude Sonnet': '#818cf8',
  'Claude Haiku':  '#22d3ee',
  'GPT-4o':        '#10b981',
  'GPT-4o Mini':   '#f59e0b'
};

const MODELS = [
  {
    name: 'Claude Opus',
    cssClass: 'claude-opus',
    totalCalls: 284320,
    avgLatency: 2.8,
    costPer1K: 0.075,
    successRate: 97.6,
    inputCost: 0.015,
    outputCost: 0.075,
    maxContext: 200000,
    tokensPerSec: 42,
    uptime: 99.7,
    contextEfficiency: 88,
    p50: 1.9,
    p95: 4.8,
    p99: 8.2
  },
  {
    name: 'Claude Sonnet',
    cssClass: 'claude-sonnet',
    totalCalls: 612450,
    avgLatency: 1.4,
    costPer1K: 0.015,
    successRate: 96.8,
    inputCost: 0.003,
    outputCost: 0.015,
    maxContext: 200000,
    tokensPerSec: 78,
    uptime: 99.8,
    contextEfficiency: 82,
    p50: 0.9,
    p95: 2.6,
    p99: 5.1
  },
  {
    name: 'Claude Haiku',
    cssClass: 'claude-haiku',
    totalCalls: 1453800,
    avgLatency: 0.5,
    costPer1K: 0.00125,
    successRate: 93.2,
    inputCost: 0.00025,
    outputCost: 0.00125,
    maxContext: 200000,
    tokensPerSec: 152,
    uptime: 99.9,
    contextEfficiency: 74,
    p50: 0.3,
    p95: 0.9,
    p99: 1.8
  },
  {
    name: 'GPT-4o',
    cssClass: 'gpt-4o',
    totalCalls: 498200,
    avgLatency: 1.7,
    costPer1K: 0.03,
    successRate: 96.1,
    inputCost: 0.005,
    outputCost: 0.015,
    maxContext: 128000,
    tokensPerSec: 65,
    uptime: 99.5,
    contextEfficiency: 79,
    p50: 1.1,
    p95: 3.2,
    p99: 6.4
  },
  {
    name: 'GPT-4o Mini',
    cssClass: 'gpt-4o-mini',
    totalCalls: 982600,
    avgLatency: 0.7,
    costPer1K: 0.0006,
    successRate: 91.4,
    inputCost: 0.00015,
    outputCost: 0.0006,
    maxContext: 128000,
    tokensPerSec: 128,
    uptime: 99.6,
    contextEfficiency: 68,
    p50: 0.4,
    p95: 1.3,
    p99: 2.5
  }
];

// ── Timestamp ──
document.getElementById('timestamp').textContent =
  'Generated ' + new Date().toLocaleString('en-US', {
    year: 'numeric', month: 'long', day: 'numeric',
    hour: '2-digit', minute: '2-digit', timeZoneName: 'short'
  });

// ─────────────────────────────────────────────
// KPI CARDS
// ─────────────────────────────────────────────
(function renderKPIs() {
  const container = document.getElementById('kpi-row');

  // Determine best in each category
  const bestCalls   = Math.max(...MODELS.map(m => m.totalCalls));
  const bestLatency = Math.min(...MODELS.map(m => m.avgLatency));
  const bestCost    = Math.min(...MODELS.map(m => m.costPer1K));
  const bestSuccess = Math.max(...MODELS.map(m => m.successRate));

  MODELS.forEach(m => {
    const card = document.createElement('div');
    card.className = 'kpi-card ' + m.cssClass;
    card.innerHTML = `
      <div class="kpi-model-name">${m.name}</div>
      <div class="kpi-metrics">
        <div class="kpi-metric">
          <span class="label">Total Calls</span>
          <span class="value${m.totalCalls === bestCalls ? ' best' : ''}">${m.totalCalls.toLocaleString()}</span>
        </div>
        <div class="kpi-metric">
          <span class="label">Avg Latency</span>
          <span class="value${m.avgLatency === bestLatency ? ' best' : ''}">${m.avgLatency.toFixed(1)}s</span>
        </div>
        <div class="kpi-metric">
          <span class="label">Cost / 1K tok</span>
          <span class="value${m.costPer1K === bestCost ? ' best' : ''}">\$${m.costPer1K < 0.01 ? m.costPer1K.toFixed(5) : m.costPer1K.toFixed(3)}</span>
        </div>
        <div class="kpi-metric">
          <span class="label">Success Rate</span>
          <span class="value${m.successRate === bestSuccess ? ' best' : ''}">${m.successRate}%</span>
        </div>
      </div>`;
    container.appendChild(card);
  });
})();

// ─────────────────────────────────────────────
// COMMON ECHARTS SETTINGS
// ─────────────────────────────────────────────
const CHART_BG = 'transparent';
const TEXT_COLOR = '#8b8fa3';
const AXIS_LINE = '#2a2d37';

function baseTextStyle() {
  return { color: TEXT_COLOR, fontFamily: "'Segoe UI', -apple-system, sans-serif" };
}

// ─────────────────────────────────────────────
// 1. RADAR CHART
// ─────────────────────────────────────────────
(function () {
  const chart = echarts.init(document.getElementById('chart-radar'));

  // Normalize values to 0-100 for radar
  const maxLatency = Math.max(...MODELS.map(m => m.avgLatency));
  const maxCost    = Math.max(...MODELS.map(m => m.costPer1K));
  const maxTPS     = Math.max(...MODELS.map(m => m.tokensPerSec));

  const series = MODELS.map(m => ({
    value: [
      Math.round((1 - m.avgLatency / (maxLatency * 1.1)) * 100),          // Speed
      Math.round(m.successRate),                                           // Quality
      Math.round((1 - m.costPer1K / (maxCost * 1.1)) * 100),             // Cost Efficiency
      Math.round((m.tokensPerSec / (maxTPS * 1.1)) * 100),               // Throughput
      Math.round(m.uptime),                                                // Reliability
      Math.round(m.contextEfficiency)                                      // Context Handling
    ],
    name: m.name
  }));

  chart.setOption({
    backgroundColor: CHART_BG,
    textStyle: baseTextStyle(),
    tooltip: {
      trigger: 'item',
      backgroundColor: '#1a1d27',
      borderColor: '#2a2d37',
      textStyle: { color: '#e0e0e0', fontSize: 12 }
    },
    legend: {
      bottom: 0,
      textStyle: { color: TEXT_COLOR, fontSize: 11 },
      itemWidth: 14,
      itemHeight: 10,
      data: MODELS.map(m => m.name)
    },
    radar: {
      indicator: [
        { name: 'Speed', max: 100 },
        { name: 'Quality', max: 100 },
        { name: 'Cost\nEfficiency', max: 100 },
        { name: 'Throughput', max: 100 },
        { name: 'Reliability', max: 100 },
        { name: 'Context\nHandling', max: 100 }
      ],
      shape: 'polygon',
      center: ['50%', '46%'],
      radius: '62%',
      axisName: { color: '#8b8fa3', fontSize: 11 },
      splitArea: { areaStyle: { color: ['rgba(42,45,55,0.3)', 'rgba(42,45,55,0.15)'] } },
      splitLine: { lineStyle: { color: '#2a2d37' } },
      axisLine: { lineStyle: { color: '#2a2d37' } }
    },
    series: [{
      type: 'radar',
      emphasis: { lineStyle: { width: 3 } },
      data: series.map((s, i) => ({
        ...s,
        symbol: 'circle',
        symbolSize: 5,
        lineStyle: { width: 2, color: MODEL_COLORS[s.name] },
        areaStyle: { color: MODEL_COLORS[s.name], opacity: 0.08 },
        itemStyle: { color: MODEL_COLORS[s.name] }
      }))
    }]
  });

  window.addEventListener('resize', () => chart.resize());
})();

// ─────────────────────────────────────────────
// 2. GROUPED BAR — Response Time by Percentile
// ─────────────────────────────────────────────
(function () {
  const chart = echarts.init(document.getElementById('chart-bar-latency'));

  const modelNames = MODELS.map(m => m.name);

  chart.setOption({
    backgroundColor: CHART_BG,
    textStyle: baseTextStyle(),
    tooltip: {
      trigger: 'axis',
      axisPointer: { type: 'shadow' },
      backgroundColor: '#1a1d27',
      borderColor: '#2a2d37',
      textStyle: { color: '#e0e0e0', fontSize: 12 },
      formatter: function (params) {
        let tip = '<b>' + params[0].axisValue + '</b><br/>';
        params.forEach(p => {
          tip += `<span style="display:inline-block;width:8px;height:8px;border-radius:50%;background:${p.color};margin-right:6px;"></span>${p.seriesName}: <b>${p.value}s</b><br/>`;
        });
        return tip;
      }
    },
    legend: {
      bottom: 0,
      textStyle: { color: TEXT_COLOR, fontSize: 11 },
      itemWidth: 14,
      itemHeight: 10
    },
    grid: { left: 48, right: 20, top: 24, bottom: 46 },
    xAxis: {
      type: 'category',
      data: modelNames,
      axisLabel: { color: TEXT_COLOR, fontSize: 11, interval: 0 },
      axisLine: { lineStyle: { color: AXIS_LINE } },
      axisTick: { show: false }
    },
    yAxis: {
      type: 'value',
      name: 'Latency (s)',
      nameTextStyle: { color: TEXT_COLOR, fontSize: 11 },
      axisLabel: { color: TEXT_COLOR, fontSize: 11 },
      splitLine: { lineStyle: { color: '#2a2d37', type: 'dashed' } },
      axisLine: { show: false }
    },
    series: [
      {
        name: 'P50',
        type: 'bar',
        barGap: '10%',
        data: MODELS.map(m => ({
          value: m.p50,
          itemStyle: { color: MODEL_COLORS[m.name], opacity: 0.5 }
        }))
      },
      {
        name: 'P95',
        type: 'bar',
        data: MODELS.map(m => ({
          value: m.p95,
          itemStyle: { color: MODEL_COLORS[m.name], opacity: 0.75 }
        }))
      },
      {
        name: 'P99',
        type: 'bar',
        data: MODELS.map(m => ({
          value: m.p99,
          itemStyle: { color: MODEL_COLORS[m.name], opacity: 1.0 }
        }))
      }
    ]
  });

  window.addEventListener('resize', () => chart.resize());
})();

// ─────────────────────────────────────────────
// 3. PARALLEL COORDINATES
// ─────────────────────────────────────────────
(function () {
  const chart = echarts.init(document.getElementById('chart-parallel'));

  const dimData = MODELS.map(m => [
    m.inputCost,
    m.outputCost,
    m.avgLatency,
    m.maxContext,
    m.successRate,
    m.tokensPerSec
  ]);

  chart.setOption({
    backgroundColor: CHART_BG,
    textStyle: baseTextStyle(),
    tooltip: {
      trigger: 'item',
      backgroundColor: '#1a1d27',
      borderColor: '#2a2d37',
      textStyle: { color: '#e0e0e0', fontSize: 12 },
      formatter: function (params) {
        const m = MODELS[params.dataIndex];
        return `<b style="color:${MODEL_COLORS[m.name]}">${m.name}</b><br/>
          Input Cost: $${m.inputCost}<br/>
          Output Cost: $${m.outputCost}<br/>
          Avg Latency: ${m.avgLatency}s<br/>
          Max Context: ${(m.maxContext / 1000).toFixed(0)}K<br/>
          Success Rate: ${m.successRate}%<br/>
          Tokens/sec: ${m.tokensPerSec}`;
      }
    },
    parallelAxis: [
      { dim: 0, name: 'Input Cost ($)', nameLocation: 'start', min: 0, max: 0.02,
        axisLabel: { formatter: '${value}' }, nameTextStyle: { color: TEXT_COLOR } },
      { dim: 1, name: 'Output Cost ($)', nameLocation: 'start', min: 0, max: 0.08,
        axisLabel: { formatter: '${value}' }, nameTextStyle: { color: TEXT_COLOR } },
      { dim: 2, name: 'Avg Latency (s)', nameLocation: 'start', min: 0, max: 3.5, inverse: true,
        nameTextStyle: { color: TEXT_COLOR } },
      { dim: 3, name: 'Max Context', nameLocation: 'start', min: 100000, max: 220000,
        axisLabel: { formatter: function(v) { return (v/1000)+'K'; } }, nameTextStyle: { color: TEXT_COLOR } },
      { dim: 4, name: 'Success Rate (%)', nameLocation: 'start', min: 88, max: 100,
        nameTextStyle: { color: TEXT_COLOR } },
      { dim: 5, name: 'Tokens/sec', nameLocation: 'start', min: 0, max: 170,
        nameTextStyle: { color: TEXT_COLOR } }
    ],
    parallel: {
      left: 70,
      right: 70,
      top: 40,
      bottom: 50,
      parallelAxisDefault: {
        type: 'value',
        nameGap: 24,
        axisLine: { lineStyle: { color: '#3a3d47' } },
        axisTick: { lineStyle: { color: '#3a3d47' } },
        axisLabel: { color: TEXT_COLOR, fontSize: 10 },
        nameTextStyle: { color: TEXT_COLOR, fontSize: 11 },
        splitLine: { show: false }
      }
    },
    series: MODELS.map((m, i) => ({
      type: 'parallel',
      name: m.name,
      lineStyle: {
        width: 3,
        color: MODEL_COLORS[m.name],
        opacity: 0.8
      },
      emphasis: {
        lineStyle: { width: 5, opacity: 1 }
      },
      data: [dimData[i]],
      smooth: true
    })),
    legend: {
      bottom: 4,
      textStyle: { color: TEXT_COLOR, fontSize: 11 },
      itemWidth: 22,
      itemHeight: 3,
      data: MODELS.map(m => m.name)
    }
  });

  window.addEventListener('resize', () => chart.resize());
})();

// ─────────────────────────────────────────────
// 4. SCATTER — Cost vs Quality
// ─────────────────────────────────────────────
(function () {
  const chart = echarts.init(document.getElementById('chart-scatter'));

  const maxCalls = Math.max(...MODELS.map(m => m.totalCalls));
  const costMedian = 0.015;
  const qualityMedian = 95;

  chart.setOption({
    backgroundColor: CHART_BG,
    textStyle: baseTextStyle(),
    tooltip: {
      trigger: 'item',
      backgroundColor: '#1a1d27',
      borderColor: '#2a2d37',
      textStyle: { color: '#e0e0e0', fontSize: 12 },
      formatter: function (params) {
        const m = MODELS[params.dataIndex];
        return `<b style="color:${MODEL_COLORS[m.name]}">${m.name}</b><br/>
          Cost/1K tokens: $${m.costPer1K < 0.01 ? m.costPer1K.toFixed(5) : m.costPer1K.toFixed(3)}<br/>
          Success Rate: ${m.successRate}%<br/>
          Total Calls: ${m.totalCalls.toLocaleString()}`;
      }
    },
    grid: { left: 56, right: 30, top: 30, bottom: 48 },
    xAxis: {
      type: 'log',
      name: 'Cost per 1K Tokens ($)',
      nameLocation: 'center',
      nameGap: 32,
      nameTextStyle: { color: TEXT_COLOR, fontSize: 11 },
      axisLabel: {
        color: TEXT_COLOR,
        fontSize: 10,
        formatter: function(v) { return '$' + (v < 0.01 ? v.toFixed(4) : v.toFixed(3)); }
      },
      splitLine: { lineStyle: { color: '#2a2d37', type: 'dashed' } },
      axisLine: { lineStyle: { color: AXIS_LINE } },
      min: 0.0004,
      max: 0.12
    },
    yAxis: {
      type: 'value',
      name: 'Task Success Rate (%)',
      nameTextStyle: { color: TEXT_COLOR, fontSize: 11 },
      axisLabel: { color: TEXT_COLOR, fontSize: 10 },
      splitLine: { lineStyle: { color: '#2a2d37', type: 'dashed' } },
      axisLine: { show: false },
      min: 89,
      max: 99
    },
    series: [
      // Quadrant lines
      {
        type: 'line',
        markLine: {
          silent: true,
          symbol: 'none',
          lineStyle: { color: '#3a3d47', type: 'dashed', width: 1 },
          data: [
            { yAxis: qualityMedian },
            { xAxis: costMedian }
          ],
          label: { show: false }
        },
        data: []
      },
      // Quadrant labels
      {
        type: 'scatter',
        data: [],
        markArea: {
          silent: true,
          data: [
            [
              { coord: [0.0004, 99], itemStyle: { color: 'rgba(16,185,129,0.04)' } },
              { coord: [costMedian, qualityMedian] }
            ],
            [
              { coord: [costMedian, 99], itemStyle: { color: 'rgba(245,158,11,0.04)' } },
              { coord: [0.12, qualityMedian] }
            ],
            [
              { coord: [0.0004, qualityMedian], itemStyle: { color: 'rgba(245,158,11,0.03)' } },
              { coord: [costMedian, 89] }
            ],
            [
              { coord: [costMedian, qualityMedian], itemStyle: { color: 'rgba(239,68,68,0.04)' } },
              { coord: [0.12, 89] }
            ]
          ]
        },
        markPoint: {
          silent: true,
          symbol: 'rect',
          symbolSize: 0,
          data: [
            {
              coord: [0.001, 98.2],
              label: { show: true, color: 'rgba(16,185,129,0.35)', fontSize: 11, fontWeight: 600,
                formatter: 'Cheap + Good' }
            },
            {
              coord: [0.06, 98.2],
              label: { show: true, color: 'rgba(245,158,11,0.35)', fontSize: 11, fontWeight: 600,
                formatter: 'Expensive + Good' }
            },
            {
              coord: [0.001, 90],
              label: { show: true, color: 'rgba(245,158,11,0.3)', fontSize: 11, fontWeight: 600,
                formatter: 'Cheap + Poor' }
            },
            {
              coord: [0.06, 90],
              label: { show: true, color: 'rgba(239,68,68,0.35)', fontSize: 11, fontWeight: 600,
                formatter: 'Expensive + Poor' }
            }
          ]
        }
      },
      // Model dots
      {
        type: 'scatter',
        data: MODELS.map((m, i) => ({
          value: [m.costPer1K, m.successRate],
          symbolSize: Math.max(18, (m.totalCalls / maxCalls) * 56),
          itemStyle: { color: MODEL_COLORS[m.name], opacity: 0.85 },
          label: {
            show: true,
            position: i === 0 ? 'top' : (i === 4 ? 'right' : 'top'),
            formatter: m.name,
            color: MODEL_COLORS[m.name],
            fontSize: 10,
            fontWeight: 600,
            distance: 8
          }
        }))
      }
    ]
  });

  window.addEventListener('resize', () => chart.resize());
})();

// ─────────────────────────────────────────────
// 5. STACKED BAR — Usage Share Over 30 Days
// ─────────────────────────────────────────────
(function () {
  const chart = echarts.init(document.getElementById('chart-stacked'));

  // Generate 30 days of data with realistic trends
  const days = [];
  const seriesData = {};
  MODELS.forEach(m => { seriesData[m.name] = []; });

  // Base daily usage per model (shifts over time to show trends)
  const baseUsage = {
    'Claude Opus':   [820, 870],
    'Claude Sonnet': [1800, 2200],
    'Claude Haiku':  [4200, 5100],
    'GPT-4o':        [1500, 1350],
    'GPT-4o Mini':   [2800, 3400]
  };

  const now = new Date();
  for (let i = 29; i >= 0; i--) {
    const d = new Date(now);
    d.setDate(d.getDate() - i);
    days.push((d.getMonth() + 1) + '/' + d.getDate());

    const progress = (29 - i) / 29; // 0 to 1 over 30 days
    MODELS.forEach(m => {
      const [start, end] = baseUsage[m.name];
      const base = start + (end - start) * progress;
      const noise = (Math.random() - 0.5) * base * 0.18;
      // Weekend dip
      const dow = d.getDay();
      const weekendFactor = (dow === 0 || dow === 6) ? 0.6 : 1.0;
      seriesData[m.name].push(Math.round((base + noise) * weekendFactor));
    });
  }

  chart.setOption({
    backgroundColor: CHART_BG,
    textStyle: baseTextStyle(),
    tooltip: {
      trigger: 'axis',
      backgroundColor: '#1a1d27',
      borderColor: '#2a2d37',
      textStyle: { color: '#e0e0e0', fontSize: 12 },
      axisPointer: { type: 'shadow' },
      formatter: function (params) {
        let total = 0;
        params.forEach(p => total += p.value);
        let tip = '<b>' + params[0].axisValue + '</b> &mdash; Total: ' + total.toLocaleString() + '<br/>';
        params.slice().reverse().forEach(p => {
          const pct = ((p.value / total) * 100).toFixed(1);
          tip += `<span style="display:inline-block;width:8px;height:8px;border-radius:50%;background:${p.color};margin-right:6px;"></span>${p.seriesName}: ${p.value.toLocaleString()} (${pct}%)<br/>`;
        });
        return tip;
      }
    },
    legend: {
      bottom: 0,
      textStyle: { color: TEXT_COLOR, fontSize: 11 },
      itemWidth: 14,
      itemHeight: 10
    },
    grid: { left: 52, right: 20, top: 20, bottom: 68 },
    xAxis: {
      type: 'category',
      data: days,
      axisLabel: { color: TEXT_COLOR, fontSize: 10, interval: 4 },
      axisLine: { lineStyle: { color: AXIS_LINE } },
      axisTick: { show: false }
    },
    yAxis: {
      type: 'value',
      name: 'API Calls',
      nameTextStyle: { color: TEXT_COLOR, fontSize: 11 },
      axisLabel: {
        color: TEXT_COLOR,
        fontSize: 10,
        formatter: function(v) { return (v / 1000).toFixed(0) + 'K'; }
      },
      splitLine: { lineStyle: { color: '#2a2d37', type: 'dashed' } },
      axisLine: { show: false }
    },
    dataZoom: [
      {
        type: 'inside',
        xAxisIndex: 0,
        start: 0,
        end: 100
      },
      {
        type: 'slider',
        xAxisIndex: 0,
        bottom: 32,
        height: 18,
        borderColor: '#2a2d37',
        backgroundColor: '#1a1d27',
        fillerColor: 'rgba(99,102,241,0.15)',
        handleStyle: { color: '#6366f1', borderColor: '#6366f1' },
        textStyle: { color: TEXT_COLOR, fontSize: 10 },
        dataBackground: {
          lineStyle: { color: '#3a3d47' },
          areaStyle: { color: 'rgba(99,102,241,0.08)' }
        },
        start: 0,
        end: 100
      }
    ],
    series: MODELS.map(m => ({
      name: m.name,
      type: 'bar',
      stack: 'usage',
      emphasis: { focus: 'series' },
      itemStyle: { color: MODEL_COLORS[m.name] },
      data: seriesData[m.name]
    }))
  });

  window.addEventListener('resize', () => chart.resize());
})();
</script>
</body>
</html>
